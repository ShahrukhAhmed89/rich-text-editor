/*!
 * =======================================================
 *  SIMPLE RICH TEXT EDITOR 1.0.6
 * =======================================================
 *
 *   Author: Taufik Nurrohman
 *   URL: https://github.com/tovic
 *   License: MIT
 *
 * -- USAGE: ---------------------------------------------
 *
 *   var e = new RTE(document.querySelector('textarea'));
 *
 * -------------------------------------------------------
 *
 */
!function(e,t,n){function pe(e){return t[r+"Element"](e)}function ge(e){return e.toLowerCase()}function ve(e){return 3===e.nodeType}function he(e){return"undefined"==typeof e}function be(e){return"function"==typeof e}function xe(e,t){return new RegExp(e,t)}function we(e,t,n){return e[a](t,n,se)}function $e(e,t,n){return e[l](t,n)}function ye(e){var f,s,n=pe("div"),i=t[r+"DocumentFragment"]();for(n[o]=e;f=n[h];)s=i[c](f);return[i[h],s,i]}var I,U,i="__instance__",r="create",f="style",s="minHeight",o="innerHTML",u="className",a="addEventListener",l="removeEventListener",c="appendChild",d="removeChild",p="parentNode",g="children",v="childNodes",h="firstChild",b="insertBefore",x="nodeName",w="getAttribute",$="setAttribute",y="removeAttribute",m="replace",C="value",S="length",A="indexOf",R="preventDefault",N="focus",E="blur",j="select",B="keydown",L="paste",_="test",T="contenteditable",H="readonly",O="spellcheck",K="placeholder",M="getSelection",z="getRangeAt",D="rangeCount",X="addRange",F="removeAllRanges",q=r+"Range",P="cloneContents",G="deleteContents",Y=j+"Node",J=Y+"Contents",Q="insertNode",V="cloneRange",W="collapse",Z="setStart",ee="setEnd",te=Z+"Before",ne=Z+"After",fe=!0,se=!1,oe=null,ue="ctrlKey",ae="shiftKey",ce="keyCode",de=setTimeout;!function(e){e.version="1.0.6",e[i]={},e.each=function(t,n){return de(function(){var r,n=e[i];for(r in n)t(n[r],r,n)},0===n?0:n||1),e},e.x="​"}(e[n]=function(r,a){function Ue(){return I=e[M]&&e[M]()||{},I[D]&&I||oe}function Me(e){return I=Ue(),I&&I[z](e||0)||oe}function ze(e,t,n){if(e){if(I=Ue()){var r,f,i=pe("div");for(r=0,f=I[D];f>r;++r)i[c](I[z](r)[P]());return e=i[o].split(Ae).join(""),e=he(t)||t?l.f(e):e,he(n)||n?e:e[m](xe(Le),"\n\n")[m](xe(_e,"g"),"")}return""}return Ue()+""}function De(e){I=Ue();var n,t=I&&I[N+"Node"]||oe;return t?(ve(t)&&t[p]!==ke&&(t=t[p]),n=ge(t[x]),e?n===e?t:oe:t):oe}function Xe(e){return(U=Me())&&(e=1===e?se:0===e?fe:e,U[W](e)),l}function Fe(e,t){if(l.is[N]){var n,r,f;return(I=Ue())&&(U=Me(),U[G](),n=ye(e),r=n[0],f=n[1],U[Q](n[2]),f&&(U=U[V](),U[ne](f),t===fe?U[te](r):(1===t?t=0:0===t&&(t=1),Xe(t)),I[F](),I[X](U))),r}return oe}function qe(t){try{var r,n=De("a"),i=ze(1,1,0)[m](/<a(\s[^<>]*?)?>|<\/a>/g,"");t=t[m](/^\s*javascript:/i,"");var f=t[0],s=e.location.hostname;return f=-1!=="/?&#"[A](f)||-1===t[A]("/"),!s||0!==t[A]("//"+s)&&-1===t[A]("://"+s)||(f=1),t?(n?n[$]("href",t):(r=Fe('<a href="'+t+'">'+i+"</a>",fe),Me()[J](r)),(n=De("a"))&&(f?(n[y]("rel"),n[y]("target")):(n[$]("rel","nofollow"),n[$]("target","blank")))):(n&&(i=n[o],n[p][d](n)),Fe(i,fe)),De("a")}catch(u){}return oe}function Pe(){var e,t,n;return(e=Me())?(t=e[V](),t[J](ke),t[ee](e.startContainer,e.startOffset),n=(t+"")[S],[n,n+(e+"")[S]]):oe}function Ge(n){if(n){var r,s,u,a,l,c,i=t[q](),f=0,o=[ke];for(i[Z](ke,0),i[W](fe);!c&&(a=o.pop());)if(ve(a))s=f+a[S],!l&&n[0]>=f&&n[0]<=s&&(i[Z](a,n[0]-f),l=1),l&&n[1]>=f&&n[1]<=s&&(i[ee](a,n[1]-f),c=1),f=s;else for(u=a[v][S];u--;)o.push(a[v][u]);r=e[M](),r[F](),r[X](i)}}function Ye(e,t,n){if(l.is[N]){he(t)&&(t=-1);var s,i=De(e),r=ze(1,1,0)[m](xe("<"+e+"(?:\\s[^<>]*?)?>|<\\/"+e+">","g"),""),f=oe;return i!==ke&&(0===t||-1===t&&i?i&&(s=i[o])&&(i[p][d](i),f=Fe(r||s,fe)):(1===t||-1===t&&!i)&&(f=Fe("<"+e+">"+r+"</"+e+">",fe)),f&&(U=Me(),U&&U[J](f),!r&&n&&Fe(n,fe))),f}return oe}function Je(e,t){e.selectionStart=e.selectionEnd=he(t)?e[C][S]:t,e[N]()}function ft(e,t){var n=e[u];return e[u]=(n+" "+t)[m](/^\s*|\s*$/g,""),e}function st(e,t){var n=e[u][m](xe("(^|\\s)\\s*"+t+"\\s*(\\s|$)","g"),"$1$2");return n?e[u]=n:e[y]("class"),e}function ot(e,t,n,i){function s(e){i.apply(this,[e,l,r]),at(),ke[N](),be(We)&&We(e,l,ke),e[R]()}var r=ft(pe("a"),t),f=n[1]||n[0];return 0===f[A]("svg:")&&(f=Y+f.slice(4)+ie),r[o]="<span>"+f+"</span>",r.title=e,r.href="javascript:;",i&&(we(r,"touchstart",s),we(r,"mousedown",s)),[r,i]}function ut(){ke[o]=l.f(r[C])[m](xe(Le,"gi"),Se+Se)[m](xe(_e,"gi"),"")}function at(){var e=l.f(ke[o]);re.tidy&&(e=e[m](xe(Le,"gi"),"</p>\n\n<p$1>")[m](xe(Re,"gi"),Se+"\n")),r[C]=e}function lt(e){return ge(e.key||String.fromCharCode(e[ce]))}function ct(e){var t=e[ue],n=e[ae],i=e[ce],f=lt(e);t&&n&&("x"===f||88===i)?(rt.x[1](),e[R]()):n||"enter"!==f&&13!==i||be(Qe)&&Qe(e,l,r),be(We)&&We(e,l,r),de(ut,1)}var Oe,Ke,Ie,l=this,h="⌘",k="⇧",Y='<svg version="1.1" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16"><path d="',ie='"></path></svg>',re={classes:["rich-text-editor"],tags:["a","abbr","b","br","code","dfn","del","em","i","ins","kbd","mark","p","span","strong","u","var"],tools:["b","i","u","x"],text:{b:["Bold",Y+"M9 10.344c0.563 0 1-0.438 1-1s-0.438-1-1-1h-2.344v2h2.344zM6.656 4.344v2h2c0.563 0 1-0.438 1-1s-0.438-1-1-1h-2zM10.406 7.188c0.875 0.406 1.438 1.281 1.438 2.281 0 1.406-1.063 2.531-2.469 2.531h-4.719v-9.344h4.188c1.5 0 2.656 1.188 2.656 2.688 0 0.688-0.438 1.406-1.094 1.844z"+ie,h+"+B"],i:["Italic",Y+"M6.656 2.656h5.344v2h-1.875l-2.25 5.344h1.469v2h-5.344v-2h1.875l2.25-5.344h-1.469v-2z"+ie,h+"+I"],u:["Underline",Y+"M3.344 12.656h9.313v1.344h-9.313v-1.344zM8 11.344c-2.219 0-4-1.781-4-4v-5.344h1.656v5.344c0 1.281 1.063 2.313 2.344 2.313s2.344-1.031 2.344-2.313v-5.344h1.656v5.344c0 2.219-1.781 4-4 4z"+ie,h+"+U"],a:["Link",Y+"M11.344 4.656c1.844 0 3.313 1.5 3.313 3.344s-1.469 3.344-3.313 3.344h-2.688v-1.281h2.688c1.125 0 2.063-0.938 2.063-2.063s-0.938-2.063-2.063-2.063h-2.688v-1.281h2.688zM5.344 8.656v-1.313h5.313v1.313h-5.313zM2.594 8c0 1.125 0.938 2.063 2.063 2.063h2.688v1.281h-2.688c-1.844 0-3.313-1.5-3.313-3.344s1.469-3.344 3.313-3.344h2.688v1.281h-2.688c-1.125 0-2.063 0.938-2.063 2.063z"+ie,h+"+L"],x:["Source",Y+"M8 6.656c0.719 0 1.344 0.625 1.344 1.344s-0.625 1.344-1.344 1.344-1.344-0.625-1.344-1.344 0.625-1.344 1.344-1.344zM12 6.656c0.719 0 1.344 0.625 1.344 1.344s-0.625 1.344-1.344 1.344-1.344-0.625-1.344-1.344 0.625-1.344 1.344-1.344zM4 6.656c0.719 0 1.344 0.625 1.344 1.344s-0.625 1.344-1.344 1.344-1.344-0.625-1.344-1.344 0.625-1.344 1.344-1.344z"+ie,h+"+"+k+"+X"]},tidy:1,enter:1,x:0,update:0},le=pe("div"),me=pe("div"),ke=pe("div"),Ce=pe("div"),Se="<br>",Ae=e[n].x,Re="<br(\\s[^<>]*?)?\\s*\\/?>",Ne="<p(\\s[^<>]*?)?>",Ee="<\\/p>",je="\\s*(?:"+Re+")\\s*",Be="^\\s*"+Ne+"(?:"+je+")*\\s*|\\s*(?:"+je+")*"+Ee+"\\s*$",Le="\\s*(?:"+je+")*"+Ee+"\\s*"+Ne+"(?:"+je+")*\\s*",_e="\\s*(?:"+Ne+"(?:"+je+")*|(?:"+je+")*"+Ee+")\\s*",Te="\\s*"+Ne+"(?:"+je+")*\\s*(?:"+je+")*"+Ee+"\\s*",He="\\s*"+Ne+"(?:"+je+")*(?:[\\s\\S]*?)(?:"+je+")*"+Ee+"\\s*";l.$=[oe,oe],l.$$=function(e,t){var n=[Ue(),Me(t)];return he(e)?n:n[e]},l.d=function(e,t,n){var i=Ce[g][0];return i[K]=e,i[C]=t,de(function(){Je(i)},1),Oe=n,l.d.v(1),l},l.d.x=function(e){return Ce[f].display="none",l.is.d=se,l.is[N]=fe,e&&(l[N](),Ge(l.$[1])),l},l.d.v=function(e){return Ce[f].display="block",l.is.d=fe,l.$[1]=e?Pe():oe,l},e[n][i][r.id||r.name||Object.keys(e[n][i])[S]]=l,a=a||{};for(Ie in re)he(a[Ie])||(re[Ie]=a[Ie]);l.is={view:fe,source:se,d:se,e:function(e){return"string"==typeof e?De(e)?fe:se:De()===e},focus:se,blur:fe};var Qe=re.enter,Ve=re.x,We=re.update,Ze=re.classes[0],et=re.text||{},tt=re.tags.join("|"),nt="a(rticle|side)|blockquote|(fig)?caption|figure|h([1-6]|eader)|div|li|[ou]l|p(re)?|section|t(able|[dh])",it=0,rt={b:function(){Ye("strong")},i:function(){Ye("em")},u:function(){Ye("u")},a:function(e){var n,i,t=ze(1,1,0);/^[a-z\d]+:\/\/\S+$/[_](t)?De("a")?Ye("a",0):qe(t):l.is.d?l.d.x(1):((n=De("a"))&&(i=n[w]("href")),l.d("http://",(i?i[m](/\/+$/,""):"http://"+ge(t[m](/\s|<[^<>]+?>/g,"")))||"",function(e,t,n){qe(n[C])}),de(function(){i&&Ce[g][0][j]()},2))},x:function(e){var t=ke.offsetHeight;t&&(r[f][s]=t+"px"),it?(l.$[0]=Pe(),st(le,"source"),ke[N](),l.$[1]&&Ge(l.$[1]),it=0):(l.$[1]=Pe(),ft(le,"source"),r[N](),l.$[0]&&Ge(l.$[0]),it=1),l.is.view=!it,l.is.source=!!it,l.d.x(),be(Ve)&&Ve(e,l,it||0)}};l.t=function(e,t,n,i){var r=ot(t[0]+(t[2]?" ("+t[2]+")":""),Ze+"-t:"+e,t,n);return he(i)?i=oe:0>i&&(i=me[g][S]+i),me[b](r[0],me[g][i]||oe),r[0]};for(Ie in rt)l.t[Ie]=rt[Ie],rt[Ie]=ot(et[Ie][0]+(et[Ie][2]?" ("+et[Ie][2]+")":""),Ze+"-t:"+Ie,et[Ie],rt[Ie]),l.t[Ie].e=rt[Ie][0];l.f=function(e){return e=e[m](/\r/g,"").split(Ae).join(""),e=e[m](/<([\w-]+?)(?:\s[^<>]*?)?>\s*<\/([\w-]+?)>/g,function(e,t,n){return t===n?"":e}),e=e[m](/<code(?:\s[^<>]*?)?>([\s\S]*?)<\/code>/g,function(e,t){return"<code>"+t[m](/(\t| {4})/g,"&nbsp;&nbsp;&nbsp;&nbsp;")+"</code>"}),e=e[m](/<(\/?)([\w-]+?)(\s[^<>]*?)?>/g,function(e,t,n,i){if(n=ge(n),!xe("^("+tt+"|"+nt+")$")[_](n))return"";i=i||"";var r=/^(h[1-6]|th)$/[_](n),f=/^((fig)?caption)$/[_](n),s=t?"":i;return"br"===n||"p"===n?"<"+t+n+">":"b"===n||"strong"===n||r?"<"+t+"strong"+s+">"+(r&&t?Se+Se:""):"i"===n||"em"===n||f?"<"+t+"em"+s+">":xe("^("+tt+")$")[_](n)?"<"+t+n+s+">":xe("^("+nt+")$")[_](n)?Se+Se:""}),e=e[m](xe(Le,"gi"),"</p><p$1>")[m](xe(je,"gi"),Se)[m](/\n/g,Se)[m](xe("(?:"+je+"){3,}","gi"),Se+Se)[m](xe("^(?:"+je+")+|(?:"+je+")+$","gi"),"")[m](xe("(?:"+je+"){2,}","gi"),"</p><p>")[m](xe(Te,"gi"),""),e=e&&!xe("^"+He+"$","gi")[_](e)?"<p>"+e+"</p>":e},ut(),at(),ft(le,Ze),ft(r,Ze+"-source"),r[$](O,se),ft(me,Ze+"-tool"),ft(ke,Ze+"-view"),Qe&&ft(le,"expand"),ke[$](T,fe),ke[$](O,se),ke[$](K,r[K]||""),we(ke,N,function(){l.is[N]=fe,ft(le,"focus")}),we(ke,E,function(){l.is[N]=se,at(),st(le,"focus")}),we(ke,L,function(){de(function(){ut();var e=ke[o];ke[o]="",Fe(e,0)},1)}),we(ke,B,function(e){var s,t=e[ue],n=e[ae],i=e[ce],r=le,f=lt(e);if(!t||n||"b"!==f&&66!==i)if(!t||n||"i"!==f&&73!==i)if(!t||n||"u"!==f&&85!==i)if(!t||n||"l"!==f&&76!==i){if(t&&n&&("x"===f||88===i))rt.x[1](),e[R]();else if(!n&&("enter"===f||13===i))if(Qe&&(I=Ue(),U=Me(),Fe(Se,0),Fe(Ae,1),e[R]()),Qe)be(Qe)&&Qe(e,l,ke);else{for(;r=r[p];)if("form"===ge(r[x])){s=r;break}s&&s.submit()}}else rt.a[1](),e[R]();else rt.u[1](),e[R]();else rt.i[1](),e[R]();else rt.b[1](),e[R]();be(We)&&We(e,l,ke),de(function(){var e=ke[o][m](xe(Ae,"g"),"");e&&e!==Se||(ke[o]=""),at()},1)}),we(r,B,ct),Ke=re.tools;for(Ie in Ke)rt[Ke[Ie]]&&me[c](rt[Ke[Ie]][0]);le[c](ke);var dt=r[p];dt&&"p"===ge(dt[x])&&(dt[p][b](r,dt),dt[p][d](dt)),r[p][b](le,r),le[c](r),le[c](me),ft(Ce,Ze+"-dialog"),Ce[o]='<input type="text">',l.d.x();var pt=Ce[g][0];return pt[$](O,se),we(pt,B,function(e){var t=this,n=e[ue],i=e[ae],r=e[ce],f=lt(e);n||i||"enter"!==f&&13!==r?i||"escape"!==f&&27!==r&&(t[C][S]||"backspace"!==f&&8!==r)||(l.d.x(1),Oe=0,e[R]()):(l.d.x(1),Oe&&Oe(e,l,t),Oe=0,be(We)&&We(e,l,ke),e[R]())}),le[c](Ce),l.container=le,l.view=ke,l.target=l.source=r,l.tool=me,l.dialog=Ce,l.config=re,l.c=Xe,l.e=De,l.i=Fe,l.r=Ge,l.s=Pe,l.v=ze,l.w=Ye,l.destroy=function(){return dt&&(le[p][b](dt,le),dt[c](r)),r[f][s]="",r[w](f)||r[y](f),st(r,Ze+"-source"),$e(r,B,ct),le[p][d](le),l},l[N]=function(e){if(l.is.view){var n=ke[o];ke[N](),l.$[1]&&Ge(l.$[1]),l.is[N]=fe,l.is[E]=se,0===e?(ke[o]="",Fe(n,1)):1===e?(ke[o]="",Fe(n,0)):e===fe&&(U=t[q](),U[J](ke),I=Ue(),I[F](),I[X](U))}else l.is.source&&(r[N](),0===e?Je(r,0):1===e?Je(r,r[C][S]):e===fe&&r[j]());return l},l[E]=function(){return l.is.view?(l.is[N]=se,l.is[E]=fe,ke[E]()):l.is.source&&r[E](),l},l.set=function(e,t){return e=l.f(e),(l.is.view||1===t)&&(e=e[m](xe(Be,"gi"),"")[m](xe(Le,"gi"),Se+Se)),he(t)?l.is.view?(ke[o]=e,at()):l.is.source?(r[C]=e,ut()):l.is.dialog&&(Ce[g][0][C]=e):0===t?(r[C]=e,ut()):1===t&&(ke[o]=e,at()),l},l.get=function(e,t){if(he(t)){var n;return l.is.view?n=ke[o]:l.is.source?n=r[C]:l.is.dialog&&(n=Ce[g][0][C]),n?n:e}return 0===t?r[C]||e:1===t?ke[o]||e:void 0},l.disable=function(){return ke[y](T),r[$](H,fe),l},l.enable=function(){return ke[$](T,fe),r[y](H),I},l})}(window,document,"RTE");