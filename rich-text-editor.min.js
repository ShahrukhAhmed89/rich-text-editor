/*!
 * =======================================================
 *  SIMPLEST RICH TEXT EDITOR 1.0.1
 * =======================================================
 *
 *   Author: Taufik Nurrohman
 *   URL: https://github.com/tovic
 *   License: MIT
 *
 * -- USAGE: ---------------------------------------------
 *
 *   var e = new RTE(document.querySelector('textarea'));
 *
 * -------------------------------------------------------
 *
 */
!function(e,n,t){function w(e,t,r){if(t&&t[p](y))try{n[k](e,r)}catch(i){}}function C(t,r){if(t&&t[p](y))try{var i=e.getSelection().getRangeAt(0),o=i.commonAncestorContainer.parentNode;r&&"a"!==o.tagName[a]()?n[k]("createLink",!1,r):(o.href="#",n[k]("unlink",!1,!1))}catch(s){}}function $(e){return n[i](e)}var r="__instance__",i="createElement",o="innerHTML",s="className",a="toLowerCase",c="addEventListener",f="appendChild",u="parentNode",l="insertBefore",p="getAttribute",b="setAttribute",d="replace",g="value",h="preventDefault",m="focus",v="test",y="contenteditable",k="execCommand",x=setTimeout;!function(e){e.version="1.0.1",e[r]={},e.each=function(n,t){return x(function(){var i,t=e[r];for(i in t)n(t[i],i,t)},0===t?0:t||1),e}}(e[t]=function(n,i){function D(e,n){return new RegExp(e,n)}function H(e){return e=e[d](/\r/g,""),e=e[d](/<code(?:\s[^<>]*?)?>([\s\S]*?)<\/code>/g,function(e,n){return"<code>"+n[d](/\n/g,"<br>")[d](/(\t| {4})/g,"&nbsp;&nbsp;&nbsp;&nbsp;")+"</code>"}),e=e[d](/<(\/?)([\w-]+?)(\s[^<>]*?)?>/g,function(e,n,t,r){if(t=t[a](),!D("^("+B+"|"+R+")$")[v](t))return"";r=r||"";var i=/^(h[1-6]|th)$/[v](t);/^((fig)?caption)$/[v](t);return"br"===t||"p"===t?"<"+n+t+">":"b"===t||"strong"===t||i?"<"+n+"strong>"+(i&&n?"<br><br>":""):"i"===t||"em"===t?"<"+n+"em>":D("^("+B+")$")[v](t)?/\bfont-weight:\s*bold\b/[v](r)?"<"+n+"strong>":/\bfont-style:\s*italic\b/[v](r)?"<"+n+"em>":/\btext-decoration:\s*underline\b/[v](r)?"<"+n+"u>":"<"+n+t+r+">":D("^("+R+")$")[v](t)?"<br>":""}),e=e[d](/<\/p>\s*<p>/g,"</p><p>")[d](/\s*<br\s*\/?>\s*/g,"<br>")[d](/\n/g,"<br>")[d](/(?:<br>){3,}/g,"<br><br>")[d](/^(?:(?:<br>)+)|(?:(?:<br>)+)$/g,"")[d](/<br><br>/g,"</p><p>")[d](/<p><\/p>/g,""),e=e?"<p>"+e+"</p>":""}function O(){E[o]=H(n[g])[d](/<\/p>\s*<p>/g,"<br><br>")[d](/<\/?p>/g,"")}function X(){n[g]=H(E[o])[d](/<\/p><p>/g,"</p>\n<p>")}function F(e,n,t,r){function a(e){r.apply(this,[e]),X(),E[m](),e[h]()}var i=$("a");return i[s]=n,i[o]="<span>"+(t[1]||t[0])+"</span>",i.title=e,i.href="javascript:;",i[c]("touchstart",a,!1),i[c]("mousedown",a,!1),[i,r]}function G(e){return(e.key||String.fromCharCode(e.keyCode))[a]()}var K,_,p=this,k={classes:["rich-text-editor"],tags:["a","abbr","b","br","code","del","em","i","ins","kbd","mark","p","span","strong","u"],text:{b:["Bold","&#x0042;"],i:["Italic","&#x0049;"],u:["Underline","&#x0055;"],a:["Link","&#x2693;"],x:["Source","&#x22EF;"]},enter:1},L=$("span"),N=$("span"),E=$("span");e[t][r][n.id||n.name||Object.keys(e[t][r]).length]=p,i=i||{};for(_ in k)"undefined"!=typeof i[_]&&(k[_]=i[_]);var S=k.classes[0],A=k.text||{},B=k.tags.join("|"),R="blockquote|(fig)?caption|figure|h[1-6]|div|li|[ou]l|pre|t(able|[dh])",j="⌘",T="⇧",U=F(A.b[0]+" ("+j+"+B)",S+"-b",A.b,function(){w("bold",E)}),M=F(A.i[0]+" ("+j+"+I)",S+"-i",A.i,function(){w("italic",E)}),I=F(A.u[0]+" ("+j+"+U)",S+"-u",A.u,function(){w("underline",E)}),z=F(A.a[0]+" ("+j+"+L)",S+"-a",A.a,function(){C(E,prompt(A.a[0],"http://"))}),q=F(A.x[0]+" ("+j+"+"+T+"+X)",S+"-x",A.x,function(){K?(L[s]=L[s][d](/\s+source$/,""),E[m](),K=0):(L[s]+=" source",n[m](),K=1)});return O(),X(),L[s]=S,n[s]=S+"-source",n[b]("spellcheck",!1),N[s]=S+"-tool",E[s]=S+"-content",k.enter&&(E[s]+=" expand"),E[b](y,!0),E[b]("spellcheck",!1),E[b]("placeholder",n.placeholder||""),E[c]("paste",function(){x(O,1)},!1),E[c]("keydown",function(e){var s,n=e.ctrlKey,t=e.shiftKey,r=e.keyCode,i=L,o=G(e);if(n&&("b"===o||!t&&66===r))U[1](),e[h]();else if(n&&("i"===o||!t&&73===r))M[1](),e[h]();else if(n&&t&&("x"===o||88===r))q[1](),e[h]();else if(n&&("u"===o||!t&&85===r))I[1](),e[h]();else if(n&&("l"===o||!t&&76===r))z[1](),e[h]();else if(!k.enter&&("enter"===o||!t&&13===r)){for(;i=i[u];)if("form"===i.nodeName[a]()){s=i;break}s&&s.submit()}x(X,1)},!1),n[c]("keydown",function(e){var n=e.ctrlKey,t=e.shiftKey,r=e.keyCode,i=G(e);n&&t&&("x"===i||88===r)&&(q[1](),e[h]()),x(O,1)},!1),N[f](U[0]),N[f](M[0]),N[f](I[0]),N[f](q[0]),L[f](E),n[u][l](L,n),L[f](n),L[f](N),p})}(window,document,"RTE");