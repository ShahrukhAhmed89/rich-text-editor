/*!
 * =======================================================
 *  SIMPLEST RICH TEXT EDITOR 1.0.4
 * =======================================================
 *
 *   Author: Taufik Nurrohman
 *   URL: https://github.com/tovic
 *   License: MIT
 *
 * -- USAGE: ---------------------------------------------
 *
 *   var e = new RTE(document.querySelector('textarea'));
 *
 * -------------------------------------------------------
 *
 */
!function(e,t,n){function ee(e){return t[i](e)}function te(e){return e.toLowerCase()}function ne(e){return"undefined"==typeof e}function re(e){return"function"==typeof e}function ie(e,t){return new RegExp(e,t)}var L,T,r="__instance__",i="createElement",o="innerHTML",f="className",s="addEventListener",u="appendChild",a="removeChild",c="parentNode",l="children",d="firstChild",p="insertBefore",g="nodeName",v="getAttribute",b="setAttribute",h="removeAttribute",x="replace",y="value",$="length",w="indexOf",k="preventDefault",C="focus",E="test",A="contenteditable",N="spellcheck",R="placeholder",B="getSelection",_="getRangeAt",j="rangeCount",H="addRange",K="removeAllRanges",D="cloneContents",F="deleteContents",O="selectNodeContents",U="insertNode",q="cloneRange",M="collapse",z="setStartBefore",X="setStartAfter",P=null,Q="ctrlKey",V="shiftKey",Y="keyCode",Z=setTimeout;!function(e){e.version="1.0.4",e[r]={},e.each=function(t,n){return Z(function(){var i,n=e[r];for(i in n)t(n[i],i,n)},0===n?0:n||1),e},e.x="‌"}(e[n]=function(i,m){function pe(e){be()[U](ae),me(e)}function ge(){ae[c]&&ae[c][a](ae)}function ve(){return L=e[B]&&e[B]()||{},L[j]&&L||P}function be(e){return L=ve(),L&&L[_](e||0)||P}function he(e,t){if(e){if(L=ve()){var r,i,n=ee("div");for(r=0,i=L[j];i>r;++r)n[u](L[_](r)[D]());return e=n[o],ne(t)||t?Ke(e):e}return""}return ve()+""}function xe(e){L=ve();var n,t=L.focusNode;return t?(3===t.nodeType&&t[c]!==fe&&(t=t[c]),n=te(t[g]),e?n===e?t:P:t):P}function me(e){return(T=be())&&(e=1===e?!0:0===e?!1:e,T[M](e)),S}function ye(e,n){var r,i,f,s,a=ee("div");if(L=ve()){for(T=be(),T[F](),a[o]=e,r=t.createDocumentFragment();i=a[d];)s=r[u](i);f=r[d],T[U](r),s&&(T=T[q](),T[X](s),n===!0?T[z](f):me(n),L[K](),L[H](T))}return f}function $e(t,n){if(t&&t[v](A))try{var f,r=xe("a"),i=he(1)[x](/^<p>|<\/p>$|<a(\s[^<>]*?)?>|<\/a>/g,"");n=n[x](/^\s*javascript:/i,"");var s=n[0],t=e.location.hostname;s="/"===s||"?"===s||"&"===s||-1===n[w]("/"),!t||0!==n[w]("//"+t)&&-1===n[w]("://"+t)||(s=1),n?(r?r[b]("href",n):(f=ye('<a href="'+n+'">'+i+"</a>",!0),be()[O](f)),(r=xe("a"))&&(s?(r[h]("rel"),r[h]("target")):(r[b]("rel","nofollow"),r[b]("target","blank")))):(r&&(i=r[o],r[c][a](r)),ye(i,!0))}catch(u){}}function we(){return L=ve(),L||""===he()?be()[q]()||P:P}function ke(e){return e&&(L=ve())&&(L[K](),L[H](e)),S}function Ce(e,t,n){ne(t)&&(t=-1);var f,s,r=xe(e),i=he(1)[x](ie("^<p>|<\\/p>$|<"+e+"(?:\\s[^<>]*?)?>|<\\/"+e+">","g"),"");return r!==fe&&(0===t||-1===t&&r?(s=r[o],r[c][a](r),f=ye(i||s,!0)):(1===t||-1===t&&!r)&&(f=ye("<"+e+">"+i+"</"+e+">",!0)),f&&(be()[O](f),!i&&n&&ye(n,!0))),f}function Se(e){e.selectionStart=e.selectionEnd=e[y][$],e[C]()}function He(e,t,n,r){function u(e){r.apply(this,[e,S,i]),Fe(),fe[C](),re(Ne)&&Ne(e,S,fe),e[k]()}var i=ee("a");return i[f]=t,i[o]="<span>"+(n[1]||n[0])+"</span>",i.title=e,i.href="javascript:;",r&&(i[s]("touchstart",u,!1),i[s]("mousedown",u,!1)),[i,r]}function Ke(e){return e=e[x](/\r/g,""),e=e[x](/<([\w-]+?)(?:\s[^<>]*?)?>\s*<\/([\w-]+?)>/g,function(e,t,n){return t===n?"":e}),e=e[x](/<code(?:\s[^<>]*?)?>([\s\S]*?)<\/code>/g,function(e,t){return"<code>"+t[x](/\n/g,ue)[x](/(\t| {4})/g,"&nbsp;&nbsp;&nbsp;&nbsp;")+"</code>"}),e=e[x](/<(\/?)([\w-]+?)(\s[^<>]*?)?>/g,function(e,t,n,r){if(n=te(n),!ie("^("+Te+"|"+Be+")$")[E](n))return"";r=r||"";var i=/^(h[1-6]|th)$/[E](n),f=(/^((fig)?caption)$/[E](n),t?"":r);return"br"===n||"p"===n?"<"+t+n+">":"b"===n||"strong"===n||i?"<"+t+"strong"+f+">"+(i&&t?ue+ue:""):"i"===n||"em"===n?"<"+t+"em"+f+">":ie("^("+Te+")$")[E](n)?"<"+t+n+f+">":ie("^("+Be+")$")[E](n)?ue+ue:""}),e=e[x](/<\/p>\s*<p>/g,"</p><p>")[x](/\s*<br\s*\/?>\s*/g,ue)[x](/\n/g,ue)[x](ie("(?:"+ue+"){3,}","g"),ue+ue)[x](ie("^(?:(?:"+ue+")+)|(?:(?:"+ue+")+)$"),"")[x](ie(ue+ue,"g"),"</p><p>")[x](/<p><\/p>/g,""),e=e&&!/^\s*<p>([\s\S]*?)<\/p>\s*$/i[E](e)?"<p>"+e+"</p>":e}function De(){fe[o]=Ke(i[y])[x](/<\/p>\s*<p>/g,ue+ue)[x](/<\/?p>/g,"")}function Fe(){i[y]=Ke(fe[o])[x](/<\/p><p>/g,"</p>\n<p>")}function Ie(e){return te(e.key||String.fromCharCode(e[Y]))}var ce,le,de,S=this,I="⌘",G="⇧",J={classes:["rich-text-editor"],tags:["a","abbr","b","br","code","del","em","i","ins","kbd","mark","p","span","strong","u"],tools:["b","i","u","x"],text:{b:["Bold","&#x0042;",I+"+B"],i:["Italic","&#x0049;",I+"+I"],u:["Underline","&#x0055;",I+"+U"],a:["Link","&#x2693;",I+"+L"],x:["Source","&#x22EF;",I+"+"+G+"+X"]},enter:1,x:0,update:0},W=ee("span"),oe=ee("span"),fe=ee("span"),se=ee("span"),ue="<br>",ae=t.createTextNode(e[n].x);S.$=[P,P],S.$$=function(e,t){return T=[ve(),be(t)],ne(e)?T:T[e]},S.d=function(e,t,n){S.$[0]=we();var r=se[l][0];return r[R]=e,r[y]=t,Z(function(){Se(r)},1),ce=n,S.d.v(1),S},S.d.x=function(e){return se.style.display="none",S.is.d=!1,e&&ke(S.$[0]),S},S.d.v=function(e){return se.style.display="block",S.is.d=!0,e&&(S.$[0]=we()),S},e[n][r][i.id||i.name||Object.keys(e[n][r])[$]]=S,m=m||{};for(de in J)ne(m[de])||(J[de]=m[de]);S.is={view:!0,source:!1,d:!1,e:function(e){return"string"==typeof e?xe(e)?!0:!1:xe()===e}};var Ee=J.enter,Ae=J.x,Ne=J.update,Re=J.classes[0],Le=J.text||{},Te=J.tags.join("|"),Be="blockquote|(fig)?caption|figure|h[1-6]|div|li|[ou]l|p(re)?|t(able|[dh])",_e=0,je={b:function(){Ce("strong")},i:function(){Ce("em")},u:function(){Ce("u")},a:function(e){var n,r,t=he();/^[a-z\d]+:\/\/\S+$/[E](t)?$e(fe,t):((n=xe("a"))&&(r=n.href),S.d("http://",(r?r[x](/\/+$/,""):"http://"+te(t[x](/\s/g,"")))||"",function(e,t,n){$e(fe,n[y])}))},x:function(e){var t=fe.offsetHeight;t&&(i.style.minHeight=t+"px"),_e?(S.$[1]=we(),W[f]=W[f][x](/\s+source$/,""),fe[C](),ke(S.$[0]),_e=0):(S.$[0]=we(),W[f]+=" source",Se(i),ke(S.$[1]),_e=1),S.is.view=!_e,S.is.source=!!_e,S.d.x(),re(Ae)&&Ae(e,S,_e||0)}};S.t=function(e,t,n,r){var i=He(t[0]+(t[2]?" ("+t[2]+")":""),Re+"-t:"+e,t,n);return ne(r)?r=P:0>r&&(r=oe[l][$]+r),oe[p](i[0],oe[l][r]||P),i[0]};for(de in je)S.t[de]=je[de],je[de]=He(Le[de][0]+(Le[de][2]?" ("+Le[de][2]+")":""),Re+"-t:"+de,Le[de],je[de]),S.t[de].e=je[de][0];De(),Fe(),W[f]=Re,i[f]=Re+"-source",i[b](N,!1),oe[f]=Re+"-tool",fe[f]=Re+"-view",Ee&&(W[f]+=" expand"),fe[b](A,!0),fe[b](N,!1),fe[b](R,i[R]||""),fe[s]("paste",function(){Z(function(){De();var e=fe[o];fe[o]="",ye(e,0)},1)},!1),fe[s]("keydown",function(e){var f,t=e[Q],n=e[V],r=e[Y],i=W,o=Ie(e);if(!t||n||"b"!==o&&66!==r)if(!t||n||"i"!==o&&73!==r)if(!t||n||"u"!==o&&85!==r)if(!t||n||"l"!==o&&76!==r)if(t&&n&&("x"===o||88===r))je.x[1](),e[k]();else if(n||"enter"!==o&&13!==r)n||"backspace"!==o&&8!==r||ge();else if(Ee&&(pe(1),ye(ue,0),e[k]()),Ee)re(Ee)&&Ee(e,S,fe);else{for(;i=i[c];)if("form"===te(i[g])){f=i;break}f&&f.submit()}else je.a[1](),e[k]();else je.u[1](),e[k]();else je.i[1](),e[k]();else je.b[1](),e[k]();re(Ne)&&Ne(e,S,fe),Z(Fe,1)},!1),fe[s]("blur",function(){ge(),Fe()}),i[s]("keydown",function(e){var t=e[Q],n=e[V],r=e[Y],o=Ie(e);t&&n&&("x"===o||88===r)?(je.x[1](),e[k]()):n||"enter"!==o&&13!==r||re(Ee)&&Ee(e,S,i),re(Ne)&&Ne(e,S,i),Z(De,1)},!1),le=J.tools;for(de in le)je[le[de]]&&oe[u](je[le[de]][0]);W[u](fe),i[c][p](W,i),W[u](i),W[u](oe),se[f]=Re+"-dialog",se[o]='<input type="text">',S.d.x();var Oe=se[l][0];return Oe[b](N,!1),Oe[s]("keydown",function(e){var t=this,n=e[Q],r=e[V],i=e[Y],o=Ie(e);n||r||"enter"!==o&&13!==i?r||"escape"!==o&&27!==i&&(t[y][$]||"backspace"!==o&&8!==i)||(S.d.x(1),fe[C](),ce=0,e[k]()):(S.d.x(1),fe[C](),ce&&ce(e,S,t),ce=0,re(Ne)&&Ne(e,S,fe),e[k]())},!1),W[u](se),S.container=W,S.view=fe,S.target=S.source=i,S.tool=oe,S.dialog=se,S.config=J,S.c=me,S.e=xe,S.f=Ke,S.i=ye,S.r=ke,S.s=we,S.v=he,S.w=Ce,S.x=function(e,t){ne(e)?ge():pe(e)},S})}(window,document,"RTE");